import{Ea as p,Jb as m,R as d,X as g,d as s,e as c,f as n,sb as l}from"./chunk-QCASI7K6.js";var v=(()=>{var e,r,h;let i=class i{constructor(){c(this,e,void 0);c(this,r,void 0);c(this,h,void 0);this.http=g(m),n(this,e,p({books:[],loading:!0})),n(this,r,p([])),n(this,h,p([])),this.allBooks=l(()=>s(this,e).call(this).books),this.loading=l(()=>s(this,e).call(this).loading),this.mapped=l(()=>s(this,r).call(this)),this.allAuthors=l(()=>s(this,h).call(this)),this.authorPostFetch=t=>{this.http.post("http://localhost:8000/author",t).subscribe(o=>{console.log(o)})},this.getAllAuthors=()=>{this.http.get("http://localhost:8000/author").subscribe(t=>{s(this,h).set(t)})},this.bookPostFetch=t=>{this.http.post("http://localhost:8000/book",t).subscribe(o=>{console.log(o)})},this.deleteBook=t=>{this.http.delete("http://localhost:8000/book/"+t).subscribe(o=>{})};let b=t=>!(new Date(t.borrowRecordBooks[0].returnDate).getTime()>Date.now());this.http.get("http://localhost:8000/book").subscribe(t=>{s(this,e).set({books:t,loading:!0});let o=t;console.log(o),o.forEach(a=>{a.borrowRecordBooks.sort((f,w)=>new Date(f.returnDate).getTime()-new Date(w.returnDate).getTime())});let k=o.map(a=>({book:a,available:a.borrowRecordBooks.length?b(a):!0}));s(this,r).set(k)})}};e=new WeakMap,r=new WeakMap,h=new WeakMap,i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=d({token:i,factory:i.\u0275fac,providedIn:"root"});let u=i;return u})();export{v as a};
